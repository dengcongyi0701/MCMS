<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>恶意域名检测系统</title>
    <!--<link rel="stylesheet" href="{{url_for('static', filename='css/search.css')}}">-->
    <link rel="shortcut icon" href="../static/icon_page.png" type="image/x-icon">
    <!-- Bootstrap core CSS -->
    <link href="{{url_for('static', filename='css/bootstrap.min.css')}}" rel="stylesheet">
    <!-- Custom styles for form -->
    <link href="{{url_for('static', filename='css/form-validation.css')}}" rel="stylesheet">
    <!--jquery-->
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.js') }}"></script>
    <!-- echart js-->
    <script type="text/javascript" src="{{url_for('static', filename='js/echarts.min.js') }}"></script>
</head>

<body class="bg-light">

<!-- 页面公共头部 导航栏 -->
<div id="headerpage">
    {% include "header.html" %}
</div>

<div class="container">
    <div class="text-center">
	    <img class="d-block mx-auto mt-2 mb-2 animated-gif" src="{{url_for('static', filename='protect.gif')}}" alt="" width="72" height="72">
        <h2 class="text-primary text-dark"><b>恶意域名检测</b></h2>
	    <p class="text-muted text-secondary">一个基于可信度模型的恶意域名检测系统
    </div>
    <!-- 恶意域名输入框 -->
    <form action="{{'\malurl_result'}}", method="POST" role="form" class="form-horizontal">
    <div class="input-group form-group">
        <input type="text" class="form-control rounded" placeholder="请输入域名或URL", name='url' />
	    <!-- 搜索按件 -->
        <button type="submit" class="btn btn-outline-primary" name="detect-url">
	    <!-- 嵌入搜索图标 -->
	    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
	        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>
	    </svg>
	    检测
	</button>
    </div>
    </form>
    <!--样本库数据统计-->
    <div class="jumbotron" style="padding:1rem 1rem; margin-top: 25px; font-size: 13px;">
        <div class="database-contanier">
            <div class="col-sm-3 label-box"><h4>样本库总量</h4><h4 style="text-primary">{{ url_total["total"] }}</h4></div>
            <div class="col-sm-3 label-box"><h4>恶意样本数</h4><h4 style="text-primary">{{ url_total["mal"] }}</h4></div>
            <div class="col-sm-3 label-box"><h4>良性样本数</h4><h4 style="text-primary">{{ url_total["benign"] }}</h4></div>
        </div>

    </div>
    <!--域名样本库-->
    <div class="jumbotron" style="padding:1rem 1rem; margin-top: 25px; font-size: 13px;">
      <div class="col-sm-12">
        <p><b>域名样本库</b>中包含了良性样本（正常域名）和恶意样本（恶意域名）两类数据，其中良性样本，采集自Alexa和Tranco_K26W-1m两个常用白名单列表，恶意样本相比于良性样本，获取过程更加复杂和困难，因此本系统使用网络爬虫技术收集国内外安全公司授权提供的威胁情报以及一些安全项目开源的威胁情报作为恶意样本数据，如360netlab、cybercrime-tracker等，本检测系统在该样本库的基础上训练得到。</p>
        <p>下图是每日收集的恶意域名数量统计图：</p>
          <!--恶意域名统计图, canvas标签会导致echarts的tooltip无法显示-->
        <div class="my-4 w-100" id="echart4" style="height: 380px;"></div>
      </div>
    </div>

<!--页脚-->
<div id="footerpage">
    {%  include 'footer.html' %}
</div>
</div>


</body>
</html>

<script type="text/javascript">
var dom = document.getElementById("echart4");
var echart4 = echarts.init(dom, {devicePixelRatio: 2.5});
var app = {};
option = null;
var dataMap = {};

option = {
    backgroundColor:"#f8f9fa",
    title:{
        show:true,
        text:"恶意样本采集数量统计图",
        x: "center",
        y: 20,
        textStyle:{fontSize:17,}
    },
    tooltip: {
        show:true,
        trigger: 'axis',
        axisPointer: {lineStyle: {color: 'red'}},
    },
    grid: {
        left: '3%',
        right: '6%',
        bottom: '10%',
        containLabel: true
    },

    xAxis: [{
        name:'(日)',
        nameTextStyle: {color: '#343a40'},
        type: 'category',
        boundaryGap: false,
        axisLabel:  {
                rotate:45,
                interval: 15,
                textStyle: {
 					color: "#343a40",
					fontSize:12,
                },
            },
        axisLine: {
			lineStyle: {
				color: '#343a40'
			}
        },
        data: {{ url_num|tojson }}.date
    }, {
        axisPointer: {show: false},
        axisLine: {  show: false},
        position: 'bottom',
        offset: 20,
    }],

    yAxis: [{
        name: '(恶意样本数)',
        nameTextStyle: {color: '#343a40'},
        type: 'value',
        axisTick: {show: false},
        axisLine: {
            lineStyle: {
                color: '#343a40'
            }
        },
       axisLabel:  {
            formatter: function(value,index){
                      var value;
                      value = value/10000+'w'
                      return value; },

            textStyle: {
                color: "#343a40",
                fontSize:13,
            },
       },

        splitLine: {
            lineStyle: {
                 color: 'rgb(108,117,125,0.2)'
            }
        }
    }],
    series: [
        {
        name: '恶意样本数',
        type: 'line',
        smooth: true,
        symbol: 'circle',
        symbolSize: 5,
        showSymbol: false,
        lineStyle: {
            normal: {
				color: '#007bff',
                width: 1
            }
        },
        areaStyle: {
            normal: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                    offset: 0,
                    color: 'rgba(0, 123, 255, 0.4)'
                }, {
                    offset: 0.8,
                    color: 'rgba(0, 123, 255, 0.1)'
                }], false),
                shadowColor: 'rgba(0, 0, 0, 0.1)',
            }
        },
        itemStyle: {
        normal: {
            color: 'red',
            borderColor: 'red',
            borderWidth: 6
            }
		},
        data: {{ url_num|tojson }}.num
    },]
    };
    echart4.setOption(option)
	window.onresize = echart4.resize;
if (option && typeof option === "object") {
    echart4.setOption(option, true);
    window.onresize = echart4.resize;
}
</script>

<style type="text/css">
.database-contanier{
    text-align: center;
    margin: 0 auto;
}
.label-box{
    display: inline-block;
}
.label-box > h4:nth-child(1){
    font-weight: bold;
    color: #343a40;
}
.label-box > h4:nth-child(2) {
    color: #17a2b8;
    font-weight: bold;
}
</style>
